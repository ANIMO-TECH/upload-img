# å›¾ç‰‡ä¸Šä¼ å·¥å…·

ä¸€ä¸ªåŸºäº Tauri + Next.js çš„æ¡Œé¢åº”ç”¨ï¼Œæ”¯æŒæ‰¹é‡ä¸Šä¼ å›¾ç‰‡å¹¶ç®¡ç†ä¸Šä¼ ç»“æœã€‚

## ğŸ¯ åŠŸèƒ½ç‰¹æ€§

- âœ… **æ‰¹é‡ä¸Šä¼ **: æ”¯æŒä¸€æ¬¡é€‰æ‹©å¤šä¸ªå›¾ç‰‡æ–‡ä»¶ä¸Šä¼ 
- âœ… **è‡ªå®šä¹‰é…ç½®**: ç”¨æˆ·å¯è‡ªå®šä¹‰ä¸Šä¼ æ¥å£é…ç½®ï¼ˆæ•æ„Ÿæ•°æ®è„±æ•ï¼‰
- âœ… **å®æ—¶è¿›åº¦**: æ˜¾ç¤ºæ¯ä¸ªæ–‡ä»¶çš„ä¸Šä¼ è¿›åº¦å’ŒçŠ¶æ€
- âœ… **æœ¬åœ°ä¿å­˜**: ä¸Šä¼ ç»“æœè‡ªåŠ¨ä¿å­˜åˆ°æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ
- âœ… **å†å²ç®¡ç†**: æŸ¥çœ‹å’Œç®¡ç†å†å²ä¸Šä¼ è®°å½•
- âœ… **å›¾ç‰‡é¢„è§ˆ**: ä¸Šä¼ æˆåŠŸåé¢„è§ˆå›¾ç‰‡å¹¶å¤åˆ¶ URL
- âœ… **è·¨å¹³å°**: æ”¯æŒ macOS Intel å’Œ M1 èŠ¯ç‰‡ï¼ˆUniversal Binaryï¼‰

## ğŸ“¦ å®‰è£…ä¸è¿è¡Œ

### å‰ç½®è¦æ±‚

- Node.js 18+
- npm æˆ– yarn
- Rust (ç”¨äºæ„å»º Tauri)
- macOS: Xcode Command Line Tools

### å¼€å‘æ¨¡å¼

```bash
# 1. å®‰è£…ä¾èµ–
npm install

# 2. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run tauri:dev
```

### ç”Ÿäº§æ„å»º

```bash
# 1. æ„å»º Next.js
npm run build

# 2. æ„å»º Tauri åº”ç”¨ï¼ˆå½“å‰æ¶æ„ï¼‰
npm run tauri:build

# 3. æ„å»º Universal Binaryï¼ˆIntel + M1ï¼‰
npm run tauri:build -- --target universal-apple-darwin
```

æ„å»ºå®Œæˆåï¼Œå®‰è£…åŒ…ä½äº `src-tauri/target/release/bundle/` ç›®å½•ã€‚

## ğŸš€ ä½¿ç”¨æŒ‡å—

### é¦–æ¬¡ä½¿ç”¨

1. **é…ç½®ä¸Šä¼ æ¥å£**
   - é¦–æ¬¡å¯åŠ¨æ—¶ä¼šè‡ªåŠ¨å¼¹å‡ºé…ç½®å¯¹è¯æ¡†
   - å¡«å†™å¿…éœ€çš„é…ç½®é¡¹ï¼š
     - **API URL**: ä¸Šä¼ æ¥å£åœ°å€ï¼ˆå¿…éœ€ï¼‰
     - **è¿‡æœŸæ—¶é—´**: æ–‡ä»¶è¿‡æœŸæ—¶é—´ï¼Œå•ä½ç§’ï¼ˆå¿…éœ€ï¼‰
     - **Trace ID**: å¯é€‰å‚æ•°
     - **User ID**: å¯é€‰å‚æ•°

2. **ä¸Šä¼ å›¾ç‰‡**
   - ç‚¹å‡»"é€‰æ‹©æ–‡ä»¶"æˆ–æ‹–æ‹½å›¾ç‰‡åˆ°ä¸Šä¼ åŒºåŸŸ
   - æ”¯æŒæ‰¹é‡é€‰æ‹©å¤šä¸ªæ–‡ä»¶
   - ç‚¹å‡»"å¼€å§‹ä¸Šä¼ "æŒ‰é’®å¼€å§‹ä¸Šä¼ 
   - å®æ—¶æŸ¥çœ‹ä¸Šä¼ è¿›åº¦

3. **ç®¡ç†å†å²è®°å½•**
   - åˆ‡æ¢åˆ°"å†å²è®°å½•"æ ‡ç­¾é¡µ
   - æŸ¥çœ‹æ‰€æœ‰ä¸Šä¼ è®°å½•
   - å¯ä»¥å¤åˆ¶ URLã€æ‰“å¼€é“¾æ¥æˆ–åˆ é™¤è®°å½•
   - æ”¯æŒå¯¼å‡ºä¸º JSON æ–‡ä»¶

4. **ä¿®æ”¹é…ç½®**
   - åˆ‡æ¢åˆ°"è®¾ç½®"æ ‡ç­¾é¡µ
   - ç‚¹å‡»"ä¿®æ”¹é…ç½®"æŒ‰é’®

## ğŸ›  æŠ€æœ¯æ ˆ

### åç«¯
- **Tauri 2.x**: è½»é‡çº§æ¡Œé¢åº”ç”¨æ¡†æ¶
- **Rust**: ç³»ç»Ÿçº§æ“ä½œå’Œæ–‡ä»¶ç®¡ç†
- **serde_json**: JSON åºåˆ—åŒ–

### å‰ç«¯
- **Next.js 14**: React æ¡†æ¶
- **TypeScript**: ç±»å‹å®‰å…¨
- **Shadcn UI**: é«˜è´¨é‡ UI ç»„ä»¶åº“
- **Tailwind CSS**: å®ç”¨ä¼˜å…ˆçš„ CSS æ¡†æ¶
- **Zustand**: è½»é‡çº§çŠ¶æ€ç®¡ç†

## ğŸ“ é¡¹ç›®ç»“æ„

```
uploadImg/
â”œâ”€â”€ app/                      # Next.js App Router
â”‚   â”œâ”€â”€ page.tsx             # ä¸»é¡µé¢
â”‚   â”œâ”€â”€ layout.tsx           # æ ¹å¸ƒå±€
â”‚   â””â”€â”€ globals.css          # å…¨å±€æ ·å¼
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ config/              # é…ç½®ç»„ä»¶
â”‚   â”‚   â””â”€â”€ ConfigDialog.tsx
â”‚   â”œâ”€â”€ upload/              # ä¸Šä¼ ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ FileSelector.tsx
â”‚   â”‚   â”œâ”€â”€ UploadQueue.tsx
â”‚   â”‚   â””â”€â”€ UploadResult.tsx
â”‚   â”œâ”€â”€ history/             # å†å²è®°å½•ç»„ä»¶
â”‚   â”‚   â””â”€â”€ HistoryList.tsx
â”‚   â””â”€â”€ ui/                  # Shadcn UI ç»„ä»¶
â”œâ”€â”€ stores/                  # Zustand çŠ¶æ€ç®¡ç†
â”‚   â”œâ”€â”€ configStore.ts
â”‚   â””â”€â”€ uploadStore.ts
â”œâ”€â”€ lib/                     # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ api.ts              # ä¸Šä¼  API
â”‚   â””â”€â”€ utils.ts            # å·¥å…·å‡½æ•°
â”œâ”€â”€ types/                   # TypeScript ç±»å‹
â”‚   â””â”€â”€ index.ts
â”œâ”€â”€ src-tauri/               # Tauri åç«¯
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ commands/       # Tauri å‘½ä»¤
â”‚   â”‚   â”‚   â”œâ”€â”€ config.rs   # é…ç½®ç®¡ç†
â”‚   â”‚   â”‚   â””â”€â”€ storage.rs  # å­˜å‚¨ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ config.rs       # é…ç½®ç±»å‹
â”‚   â”‚   â”œâ”€â”€ storage.rs      # å­˜å‚¨ç±»å‹
â”‚   â”‚   â””â”€â”€ main.rs         # ä¸»å…¥å£
â”‚   â”œâ”€â”€ Cargo.toml          # Rust ä¾èµ–
â”‚   â””â”€â”€ tauri.conf.json     # Tauri é…ç½®
â””â”€â”€ package.json
```

## ğŸ” é…ç½®æ–‡ä»¶è¯´æ˜

### config.json

é…ç½®æ–‡ä»¶ä¿å­˜åœ¨ `~/Library/Application Support/com.upload-img.app/`ï¼š

```json
{
  "apiUrl": "https://example.com/api/upload",
  "expireTime": "3600",
  "traceId": "",
  "userId": "",
  "headers": {}
}
```

### history.json

å†å²è®°å½•ä¿å­˜åœ¨åŒä¸€ç›®å½•ï¼š

```json
{
  "records": [
    {
      "id": "uuid",
      "file_name": "example.png",
      "file_size": 102400,
      "local_path": "",
      "upload_url": "https://cdn.example.com/xxx.png",
      "uploaded_at": "2025-01-15T10:30:00Z",
      "status": "success"
    }
  ]
}
```

## ğŸ”§ è‡ªå®šä¹‰å¼€å‘

### ä¿®æ”¹ä¸Šä¼ æ¥å£

å¦‚æœéœ€è¦é€‚é…ä¸åŒçš„ä¸Šä¼ æ¥å£ï¼Œä¿®æ”¹ `lib/api.ts` ä¸­çš„ `uploadFile` å‡½æ•°ï¼š

```typescript
// æ·»åŠ è‡ªå®šä¹‰ headers æˆ–å‚æ•°
const formData = new FormData();
formData.append('file', file);
formData.append('expireTime', config.expireTime);
// æ·»åŠ å…¶ä»–å‚æ•°...
```

### æ·»åŠ æ›´å¤š UI ç»„ä»¶

ä½¿ç”¨ Shadcn UI CLI æ·»åŠ ç»„ä»¶ï¼š

```bash
npx shadcn-ui@latest add [component-name]
```

### ä¿®æ”¹åº”ç”¨å›¾æ ‡

æ›¿æ¢ `src-tauri/icons/` ç›®å½•ä¸‹çš„å›¾æ ‡æ–‡ä»¶ï¼š
- `icon.icns` - macOS å›¾æ ‡
- `icon.ico` - Windows å›¾æ ‡
- `32x32.png` / `128x128.png` - Linux å›¾æ ‡

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **æ–‡ä»¶ç±»å‹é™åˆ¶**: ç›®å‰ä»…æ”¯æŒå›¾ç‰‡æ ¼å¼ï¼ˆJPEGã€PNGã€GIFã€WebPï¼‰
2. **å¹¶å‘æ§åˆ¶**: é»˜è®¤æœ€å¤š 3 ä¸ªæ–‡ä»¶åŒæ—¶ä¸Šä¼ 
3. **è¶…æ—¶è®¾ç½®**: å•ä¸ªæ–‡ä»¶ä¸Šä¼ è¶…æ—¶æ—¶é—´ä¸º 60 ç§’
4. **æ•°æ®å®‰å…¨**: é…ç½®æ–‡ä»¶å’Œå†å²è®°å½•ä¿å­˜åœ¨æœ¬åœ°ï¼Œè¯·å¦¥å–„ä¿ç®¡

## ğŸ› æ•…éšœæ’æŸ¥

### Rust ç¼–è¯‘é”™è¯¯

```bash
# æ›´æ–° Rust
rustup update

# æ¸…ç†å¹¶é‡æ–°æ„å»º
cd src-tauri
cargo clean
cargo build
```

### Tauri CLI é—®é¢˜

```bash
# é‡æ–°å®‰è£… Tauri CLI
npm uninstall @tauri-apps/cli
npm install -D @tauri-apps/cli@latest
```

### æƒé™é—®é¢˜

ç¡®ä¿ `src-tauri/capabilities/default.json` ä¸­é…ç½®äº†æ­£ç¡®çš„æ–‡ä»¶ç³»ç»Ÿæƒé™ã€‚

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼
